{"ast":null,"code":"var _jsxFileName = \"/Users/invotradesign/MYGitHub/CascadeProjects/site-users-app/src/components/OrgChart.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport Tree from 'react-d3-tree';\nimport { useUsers } from './UserContext';\nimport { Box, Card, Avatar, Typography, useTheme as useMuiTheme, alpha, IconButton } from '@mui/material';\nimport { Add as AddIcon, Remove as RemoveIcon } from '@mui/icons-material';\nimport { useTheme } from './ThemeContext';\n\n// Update the TreeNodeAttributes interface to include the additional fields\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stringToColor = string => {\n  let hash = 0;\n  for (let i = 0; i < string.length; i++) {\n    hash = string.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = hash >> i * 8 & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n  return color;\n};\nconst convertToRawNodeDatum = node => {\n  var _node$children;\n  return {\n    name: node.name,\n    attributes: node.attributes,\n    children: (_node$children = node.children) === null || _node$children === void 0 ? void 0 : _node$children.map(convertToRawNodeDatum)\n  };\n};\nconst OrgChart = () => {\n  _s();\n  const muiTheme = useMuiTheme();\n  const {\n    headingFontWeights,\n    pageTitleFontSize,\n    headingFont\n  } = useTheme();\n  const {\n    users\n  } = useUsers();\n  const [treeData, setTreeData] = useState(null);\n  const [dimensions, setDimensions] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight\n  });\n  const [expandedNodes, setExpandedNodes] = useState(new Set());\n  const [isAllExpanded, setIsAllExpanded] = useState(false);\n\n  // Update dimensions on window resize\n  useEffect(() => {\n    const handleResize = () => {\n      setDimensions({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    };\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  useEffect(() => {\n    const buildTreeData = users => {\n      if (!users.length) return null;\n      const userMap = new Map(users.map(user => [user.id, user]));\n\n      // Find John Doe or fallback to the root\n      const root = users.find(user => {\n        var _user$directReports;\n        return user.name === \"John Doe\" || !user.managerId && (user.jobRole.toLowerCase().includes('ceo') || user.jobRole.toLowerCase().includes('chief') || ((_user$directReports = user.directReports) === null || _user$directReports === void 0 ? void 0 : _user$directReports.length));\n      }) || users[0];\n      const buildNode = user => {\n        const directReportIds = new Set();\n        if (user.directReports) {\n          user.directReports.forEach(id => directReportIds.add(id));\n        }\n        users.forEach(u => {\n          if (u.managerId === user.id) {\n            directReportIds.add(u.id);\n          }\n        });\n        const children = Array.from(directReportIds).map(id => userMap.get(id)).filter(u => u !== undefined).map(child => buildNode(child));\n        const hasChildren = children.length > 0;\n        return {\n          name: user.name,\n          id: user.id.toString(),\n          attributes: {\n            name: user.name,\n            role: user.jobRole,\n            team: user.team,\n            location: user.location,\n            email: user.email,\n            id: user.id.toString(),\n            hasChildren\n          },\n          children: hasChildren ? children : undefined\n        };\n      };\n      const data = buildNode(root);\n\n      // Only expand the root node initially\n      setExpandedNodes(new Set([data.id]));\n      return data;\n    };\n    const data = buildTreeData(users);\n    setTreeData(data);\n  }, [users]);\n\n  // Function to collect all node IDs\n  const getAllNodeIds = node => {\n    const ids = [node.id];\n    if (node.children) {\n      node.children.forEach(child => {\n        ids.push(...getAllNodeIds(child));\n      });\n    }\n    return ids;\n  };\n\n  // Function to get root's immediate children IDs\n  const getRootAndImmediateChildren = node => {\n    const ids = [node.id];\n    if (node.children) {\n      node.children.forEach(child => {\n        ids.push(child.id);\n      });\n    }\n    return ids;\n  };\n  const toggleAllNodes = () => {\n    if (!treeData) return;\n    const newIsExpanded = !isAllExpanded;\n    let newExpandedNodes;\n    if (newIsExpanded) {\n      // Expand all nodes\n      newExpandedNodes = new Set(getAllNodeIds(treeData));\n    } else {\n      // Collapse all except root and immediate children\n      newExpandedNodes = new Set(getRootAndImmediateChildren(treeData));\n    }\n    setIsAllExpanded(newIsExpanded);\n    setExpandedNodes(newExpandedNodes);\n  };\n\n  // Update toggle state when individual nodes are toggled\n  const toggleNode = nodeId => {\n    setExpandedNodes(prev => {\n      const next = new Set(prev);\n      if (next.has(nodeId)) {\n        // When collapsing, also remove all descendant nodes\n        const removeDescendants = node => {\n          var _node$children2;\n          next.delete(node.id);\n          (_node$children2 = node.children) === null || _node$children2 === void 0 ? void 0 : _node$children2.forEach(removeDescendants);\n        };\n        const findNode = (nodeToFind, currentNode) => {\n          if (currentNode.id === nodeToFind) return currentNode;\n          if (!currentNode.children) return null;\n          for (const child of currentNode.children) {\n            const found = findNode(nodeToFind, child);\n            if (found) return found;\n          }\n          return null;\n        };\n        if (treeData) {\n          const nodeToCollapse = findNode(nodeId, treeData);\n          if (nodeToCollapse) {\n            removeDescendants(nodeToCollapse);\n            next.delete(nodeId);\n          }\n        }\n      } else {\n        next.add(nodeId);\n      }\n\n      // Update isAllExpanded state based on the number of expanded nodes\n      if (treeData) {\n        const allNodes = getAllNodeIds(treeData);\n        setIsAllExpanded(allNodes.every(id => next.has(id)));\n      }\n      return next;\n    });\n  };\n  const processTreeData = node => {\n    const isExpanded = expandedNodes.has(node.id);\n    return {\n      name: node.name,\n      attributes: {\n        ...node.attributes,\n        id: node.id,\n        hasChildren: Boolean(node.children && node.children.length > 0)\n      },\n      children: isExpanded && node.children ? node.children.map(processTreeData) : undefined\n    };\n  };\n  const renderCustomNode = ({\n    nodeDatum\n  }) => {\n    const attrs = nodeDatum.attributes;\n    const isMobile = dimensions.width < 600;\n\n    // Return a default node if attributes are missing\n    if (!attrs) {\n      return /*#__PURE__*/_jsxDEV(\"g\", {\n        children: /*#__PURE__*/_jsxDEV(\"foreignObject\", {\n          x: isMobile ? -40 : -60,\n          y: isMobile ? -20 : -25,\n          width: isMobile ? 80 : 120,\n          height: isMobile ? 40 : 50,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            variant: \"outlined\",\n            sx: {\n              p: 1,\n              width: '100%',\n              height: '100%',\n              bgcolor: alpha(muiTheme.palette.background.paper, 0.98),\n              borderRadius: '8px',\n              transition: 'all 0.2s ease-in-out',\n              borderColor: alpha(muiTheme.palette.divider, 0.8),\n              '&:hover': {\n                borderColor: muiTheme.palette.primary.main\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: isMobile ? \"caption\" : \"body2\",\n              align: \"center\",\n              display: \"block\",\n              sx: {\n                fontWeight: 500\n              },\n              children: nodeDatum.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this);\n    }\n    const initials = attrs.name.split(' ').map(n => n[0]).join('');\n    const bgColor = stringToColor(attrs.name);\n    const hasChildren = attrs.hasChildren;\n    const isExpanded = expandedNodes.has(attrs.id);\n    return /*#__PURE__*/_jsxDEV(\"g\", {\n      children: /*#__PURE__*/_jsxDEV(\"foreignObject\", {\n        x: isMobile ? -75 : -100,\n        y: isMobile ? -40 : -50,\n        width: isMobile ? 150 : 200,\n        height: isMobile ? 80 : 100,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          variant: \"outlined\",\n          sx: {\n            width: '100%',\n            height: '100%',\n            bgcolor: alpha(muiTheme.palette.background.paper, 0.98),\n            borderRadius: '12px',\n            overflow: 'visible',\n            position: 'relative',\n            cursor: hasChildren ? 'pointer' : 'default',\n            transition: 'all 0.2s ease-in-out',\n            borderColor: alpha(muiTheme.palette.divider, 0.8),\n            '&:hover': hasChildren ? {\n              borderColor: muiTheme.palette.primary.main,\n              bgcolor: alpha(muiTheme.palette.background.paper, 0.99),\n              '& .MuiIconButton-root': {\n                color: muiTheme.palette.primary.main,\n                bgcolor: alpha(muiTheme.palette.primary.main, 0.08)\n              }\n            } : {}\n          },\n          onClick: () => hasChildren && toggleNode(attrs.id),\n          children: [hasChildren && /*#__PURE__*/_jsxDEV(IconButton, {\n            size: \"small\",\n            onClick: e => {\n              e.stopPropagation();\n              toggleNode(attrs.id);\n            },\n            sx: {\n              position: 'absolute',\n              right: '8px',\n              top: '8px',\n              width: '24px',\n              height: '24px',\n              p: 0.5,\n              color: muiTheme.palette.text.secondary,\n              bgcolor: alpha(muiTheme.palette.background.paper, 1),\n              border: `1px solid ${alpha(muiTheme.palette.divider, 0.8)}`,\n              '&:hover': {\n                bgcolor: alpha(muiTheme.palette.primary.main, 0.08),\n                color: muiTheme.palette.primary.main,\n                borderColor: muiTheme.palette.primary.main\n              }\n            },\n            children: isExpanded ? /*#__PURE__*/_jsxDEV(RemoveIcon, {\n              fontSize: \"small\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 31\n            }, this) : /*#__PURE__*/_jsxDEV(AddIcon, {\n              fontSize: \"small\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 65\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: isMobile ? 1 : 1.5,\n              p: isMobile ? 1.25 : 1.5\n            },\n            children: [/*#__PURE__*/_jsxDEV(Avatar, {\n              sx: {\n                width: isMobile ? 38 : 48,\n                height: isMobile ? 38 : 48,\n                bgcolor: alpha(bgColor, 0.9),\n                fontSize: isMobile ? '1rem' : '1.2rem',\n                fontWeight: 600\n              },\n              children: initials\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                minWidth: 0,\n                flex: 1\n              },\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                variant: isMobile ? \"body2\" : \"subtitle1\",\n                sx: {\n                  fontWeight: 600,\n                  whiteSpace: 'nowrap',\n                  overflow: 'hidden',\n                  textOverflow: 'ellipsis',\n                  fontSize: isMobile ? '0.875rem' : '1rem',\n                  lineHeight: 1.2,\n                  mb: 0.5,\n                  pr: hasChildren ? 3 : 0,\n                  color: muiTheme.palette.text.primary\n                },\n                children: attrs.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"caption\",\n                sx: {\n                  display: 'block',\n                  whiteSpace: 'nowrap',\n                  overflow: 'hidden',\n                  textOverflow: 'ellipsis',\n                  fontSize: isMobile ? '0.75rem' : '0.8125rem',\n                  lineHeight: 1.2,\n                  mb: 0.25,\n                  color: muiTheme.palette.text.secondary,\n                  fontWeight: 500\n                },\n                children: attrs.role\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 389,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"caption\",\n                sx: {\n                  display: 'block',\n                  whiteSpace: 'nowrap',\n                  overflow: 'hidden',\n                  textOverflow: 'ellipsis',\n                  fontSize: isMobile ? '0.75rem' : '0.8125rem',\n                  lineHeight: 1.2,\n                  color: muiTheme.palette.primary.main,\n                  fontWeight: 500\n                },\n                children: attrs.team\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this);\n  };\n  if (!treeData) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        p: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        children: \"Loading organization chart...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      height: '100vh',\n      p: 3\n    },\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mb: 3,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        component: \"h1\",\n        sx: {\n          fontWeight: (headingFontWeights === null || headingFontWeights === void 0 ? void 0 : headingFontWeights.pageTitle) || 700,\n          fontSize: pageTitleFontSize,\n          fontFamily: headingFont\n        },\n        children: \"Organization Chart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: toggleAllNodes,\n        sx: {\n          border: `1px solid ${alpha(muiTheme.palette.divider, 0.8)}`,\n          borderRadius: 1,\n          p: 1,\n          color: muiTheme.palette.text.secondary,\n          '&:hover': {\n            bgcolor: alpha(muiTheme.palette.primary.main, 0.08),\n            color: muiTheme.palette.primary.main,\n            borderColor: muiTheme.palette.primary.main\n          }\n        },\n        children: isAllExpanded ? /*#__PURE__*/_jsxDEV(RemoveIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 28\n        }, this) : /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 45\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        width: '100%',\n        height: 'calc(100vh - 64px)'\n      },\n      children: /*#__PURE__*/_jsxDEV(Tree, {\n        data: treeData ? processTreeData(treeData) : {\n          name: 'No Data'\n        },\n        renderCustomNodeElement: renderCustomNode,\n        orientation: \"vertical\",\n        pathFunc: \"step\",\n        translate: {\n          x: dimensions.width / 2,\n          y: Math.min(100, dimensions.height * 0.1)\n        },\n        separation: {\n          siblings: 2,\n          nonSiblings: 2\n        },\n        zoom: 0.6,\n        nodeSize: {\n          x: 300,\n          y: 150\n        },\n        enableLegacyTransitions: true,\n        transitionDuration: 800,\n        scaleExtent: {\n          min: 0.1,\n          max: 2\n        },\n        hasInteractiveNodes: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 472,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 437,\n    columnNumber: 5\n  }, this);\n};\n_s(OrgChart, \"x7GUCa3DWXinj4g7tvq1NCfOyCA=\", false, function () {\n  return [useMuiTheme, useTheme, useUsers];\n});\n_c = OrgChart;\nexport default OrgChart;\nvar _c;\n$RefreshReg$(_c, \"OrgChart\");","map":{"version":3,"names":["React","useEffect","useState","Tree","useUsers","Box","Card","Avatar","Typography","useTheme","useMuiTheme","alpha","IconButton","Add","AddIcon","Remove","RemoveIcon","jsxDEV","_jsxDEV","stringToColor","string","hash","i","length","charCodeAt","color","value","toString","substr","convertToRawNodeDatum","node","_node$children","name","attributes","children","map","OrgChart","_s","muiTheme","headingFontWeights","pageTitleFontSize","headingFont","users","treeData","setTreeData","dimensions","setDimensions","width","window","innerWidth","height","innerHeight","expandedNodes","setExpandedNodes","Set","isAllExpanded","setIsAllExpanded","handleResize","addEventListener","removeEventListener","buildTreeData","userMap","Map","user","id","root","find","_user$directReports","managerId","jobRole","toLowerCase","includes","directReports","buildNode","directReportIds","forEach","add","u","Array","from","get","filter","undefined","child","hasChildren","role","team","location","email","data","getAllNodeIds","ids","push","getRootAndImmediateChildren","toggleAllNodes","newIsExpanded","newExpandedNodes","toggleNode","nodeId","prev","next","has","removeDescendants","_node$children2","delete","findNode","nodeToFind","currentNode","found","nodeToCollapse","allNodes","every","processTreeData","isExpanded","Boolean","renderCustomNode","nodeDatum","attrs","isMobile","x","y","variant","sx","p","bgcolor","palette","background","paper","borderRadius","transition","borderColor","divider","primary","main","align","display","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","initials","split","n","join","bgColor","overflow","position","cursor","onClick","size","e","stopPropagation","right","top","text","secondary","border","fontSize","alignItems","gap","minWidth","flex","whiteSpace","textOverflow","lineHeight","mb","pr","justifyContent","component","pageTitle","fontFamily","renderCustomNodeElement","orientation","pathFunc","translate","Math","min","separation","siblings","nonSiblings","zoom","nodeSize","enableLegacyTransitions","transitionDuration","scaleExtent","max","hasInteractiveNodes","_c","$RefreshReg$"],"sources":["/Users/invotradesign/MYGitHub/CascadeProjects/site-users-app/src/components/OrgChart.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Tree, { RawNodeDatum, CustomNodeElementProps } from 'react-d3-tree';\nimport { User } from '../types/User';\nimport { useUsers } from './UserContext';\nimport {\n  Box,\n  Card,\n  Avatar,\n  Typography,\n  useTheme as useMuiTheme,\n  alpha,\n  IconButton\n} from '@mui/material';\nimport { Add as AddIcon, Remove as RemoveIcon } from '@mui/icons-material';\nimport { useTheme } from './ThemeContext';\n\ntype NodeAttributes = {\n  name: string;\n  role: string;\n  team: string;\n  location: string;\n  email: string;\n}\n\n// Update the TreeNodeAttributes interface to include the additional fields\ntype TreeNodeAttributes = Record<keyof NodeAttributes, string> & {\n  id: string;\n  hasChildren: boolean;\n};\n\ninterface OrgChartNodeData {\n  name: string;\n  attributes?: TreeNodeAttributes;\n  children?: OrgChartNodeData[];\n  id: string;\n}\n\nconst stringToColor = (string: string) => {\n  let hash = 0;\n  for (let i = 0; i < string.length; i++) {\n    hash = string.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n  return color;\n};\n\nconst convertToRawNodeDatum = (node: OrgChartNodeData): RawNodeDatum => {\n  return {\n    name: node.name,\n    attributes: node.attributes,\n    children: node.children?.map(convertToRawNodeDatum)\n  };\n};\n\nconst OrgChart: React.FC = () => {\n  const muiTheme = useMuiTheme();\n  const { headingFontWeights, pageTitleFontSize, headingFont } = useTheme();\n  const { users } = useUsers();\n  const [treeData, setTreeData] = useState<OrgChartNodeData | null>(null);\n  const [dimensions, setDimensions] = useState({ \n    width: window.innerWidth, \n    height: window.innerHeight \n  });\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n  const [isAllExpanded, setIsAllExpanded] = useState(false);\n\n  // Update dimensions on window resize\n  useEffect(() => {\n    const handleResize = () => {\n      setDimensions({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  useEffect(() => {\n    const buildTreeData = (users: User[]): OrgChartNodeData | null => {\n      if (!users.length) return null;\n\n      const userMap = new Map(users.map(user => [user.id, user]));\n      \n      // Find John Doe or fallback to the root\n      const root = users.find(user => \n        user.name === \"John Doe\" || (\n          !user.managerId && (\n            user.jobRole.toLowerCase().includes('ceo') || \n            user.jobRole.toLowerCase().includes('chief') ||\n            user.directReports?.length\n          )\n        )\n      ) || users[0];\n\n      const buildNode = (user: User): OrgChartNodeData => {\n        const directReportIds = new Set<number>();\n        \n        if (user.directReports) {\n          user.directReports.forEach(id => directReportIds.add(id));\n        }\n        \n        users.forEach(u => {\n          if (u.managerId === user.id) {\n            directReportIds.add(u.id);\n          }\n        });\n\n        const children = Array.from(directReportIds)\n          .map(id => userMap.get(id))\n          .filter((u): u is User => u !== undefined)\n          .map(child => buildNode(child));\n\n        const hasChildren = children.length > 0;\n\n        return {\n          name: user.name,\n          id: user.id.toString(),\n          attributes: {\n            name: user.name,\n            role: user.jobRole,\n            team: user.team,\n            location: user.location,\n            email: user.email,\n            id: user.id.toString(),\n            hasChildren\n          },\n          children: hasChildren ? children : undefined\n        };\n      };\n\n      const data = buildNode(root);\n      \n      // Only expand the root node initially\n      setExpandedNodes(new Set([data.id]));\n      return data;\n    };\n\n    const data = buildTreeData(users);\n    setTreeData(data);\n  }, [users]);\n\n  // Function to collect all node IDs\n  const getAllNodeIds = (node: OrgChartNodeData): string[] => {\n    const ids: string[] = [node.id];\n    if (node.children) {\n      node.children.forEach(child => {\n        ids.push(...getAllNodeIds(child));\n      });\n    }\n    return ids;\n  };\n\n  // Function to get root's immediate children IDs\n  const getRootAndImmediateChildren = (node: OrgChartNodeData): string[] => {\n    const ids = [node.id];\n    if (node.children) {\n      node.children.forEach(child => {\n        ids.push(child.id);\n      });\n    }\n    return ids;\n  };\n\n  const toggleAllNodes = () => {\n    if (!treeData) return;\n\n    const newIsExpanded = !isAllExpanded;\n    let newExpandedNodes: Set<string>;\n\n    if (newIsExpanded) {\n      // Expand all nodes\n      newExpandedNodes = new Set(getAllNodeIds(treeData));\n    } else {\n      // Collapse all except root and immediate children\n      newExpandedNodes = new Set(getRootAndImmediateChildren(treeData));\n    }\n\n    setIsAllExpanded(newIsExpanded);\n    setExpandedNodes(newExpandedNodes);\n  };\n\n  // Update toggle state when individual nodes are toggled\n  const toggleNode = (nodeId: string) => {\n    setExpandedNodes(prev => {\n      const next = new Set(prev);\n      if (next.has(nodeId)) {\n        // When collapsing, also remove all descendant nodes\n        const removeDescendants = (node: OrgChartNodeData) => {\n          next.delete(node.id);\n          node.children?.forEach(removeDescendants);\n        };\n        \n        const findNode = (nodeToFind: string, currentNode: OrgChartNodeData): OrgChartNodeData | null => {\n          if (currentNode.id === nodeToFind) return currentNode;\n          if (!currentNode.children) return null;\n          \n          for (const child of currentNode.children) {\n            const found = findNode(nodeToFind, child);\n            if (found) return found;\n          }\n          return null;\n        };\n\n        if (treeData) {\n          const nodeToCollapse = findNode(nodeId, treeData);\n          if (nodeToCollapse) {\n            removeDescendants(nodeToCollapse);\n            next.delete(nodeId);\n          }\n        }\n      } else {\n        next.add(nodeId);\n      }\n\n      // Update isAllExpanded state based on the number of expanded nodes\n      if (treeData) {\n        const allNodes = getAllNodeIds(treeData);\n        setIsAllExpanded(allNodes.every(id => next.has(id)));\n      }\n\n      return next;\n    });\n  };\n\n  const processTreeData = (node: OrgChartNodeData): RawNodeDatum => {\n    const isExpanded = expandedNodes.has(node.id);\n    \n    return {\n      name: node.name,\n      attributes: {\n        ...node.attributes,\n        id: node.id,\n        hasChildren: Boolean(node.children && node.children.length > 0)\n      },\n      children: isExpanded && node.children \n        ? node.children.map(processTreeData)\n        : undefined\n    };\n  };\n\n  const renderCustomNode = ({ nodeDatum }: CustomNodeElementProps): React.ReactElement => {\n    const attrs = nodeDatum.attributes as TreeNodeAttributes;\n    const isMobile = dimensions.width < 600;\n    \n    // Return a default node if attributes are missing\n    if (!attrs) {\n      return (\n        <g>\n          <foreignObject \n            x={isMobile ? -40 : -60} \n            y={isMobile ? -20 : -25} \n            width={isMobile ? 80 : 120} \n            height={isMobile ? 40 : 50}\n          >\n            <Card\n              variant=\"outlined\"\n              sx={{\n                p: 1,\n                width: '100%',\n                height: '100%',\n                bgcolor: alpha(muiTheme.palette.background.paper, 0.98),\n                borderRadius: '8px',\n                transition: 'all 0.2s ease-in-out',\n                borderColor: alpha(muiTheme.palette.divider, 0.8),\n                '&:hover': {\n                  borderColor: muiTheme.palette.primary.main,\n                }\n              }}\n            >\n              <Typography \n                variant={isMobile ? \"caption\" : \"body2\"} \n                align=\"center\" \n                display=\"block\"\n                sx={{ fontWeight: 500 }}\n              >\n                {nodeDatum.name}\n              </Typography>\n            </Card>\n          </foreignObject>\n        </g>\n      );\n    }\n\n    const initials = attrs.name.split(' ').map(n => n[0]).join('');\n    const bgColor = stringToColor(attrs.name);\n    const hasChildren = attrs.hasChildren;\n    const isExpanded = expandedNodes.has(attrs.id);\n\n    return (\n      <g>\n        <foreignObject \n          x={isMobile ? -75 : -100} \n          y={isMobile ? -40 : -50} \n          width={isMobile ? 150 : 200} \n          height={isMobile ? 80 : 100}\n        >\n          <Card\n            variant=\"outlined\"\n            sx={{\n              width: '100%',\n              height: '100%',\n              bgcolor: alpha(muiTheme.palette.background.paper, 0.98),\n              borderRadius: '12px',\n              overflow: 'visible',\n              position: 'relative',\n              cursor: hasChildren ? 'pointer' : 'default',\n              transition: 'all 0.2s ease-in-out',\n              borderColor: alpha(muiTheme.palette.divider, 0.8),\n              '&:hover': hasChildren ? {\n                borderColor: muiTheme.palette.primary.main,\n                bgcolor: alpha(muiTheme.palette.background.paper, 0.99),\n                '& .MuiIconButton-root': {\n                  color: muiTheme.palette.primary.main,\n                  bgcolor: alpha(muiTheme.palette.primary.main, 0.08),\n                }\n              } : {}\n            }}\n            onClick={() => hasChildren && toggleNode(attrs.id)}\n          >\n            {hasChildren && (\n              <IconButton\n                size=\"small\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  toggleNode(attrs.id);\n                }}\n                sx={{\n                  position: 'absolute',\n                  right: '8px',\n                  top: '8px',\n                  width: '24px',\n                  height: '24px',\n                  p: 0.5,\n                  color: muiTheme.palette.text.secondary,\n                  bgcolor: alpha(muiTheme.palette.background.paper, 1),\n                  border: `1px solid ${alpha(muiTheme.palette.divider, 0.8)}`,\n                  '&:hover': {\n                    bgcolor: alpha(muiTheme.palette.primary.main, 0.08),\n                    color: muiTheme.palette.primary.main,\n                    borderColor: muiTheme.palette.primary.main,\n                  }\n                }}\n              >\n                {isExpanded ? <RemoveIcon fontSize=\"small\" /> : <AddIcon fontSize=\"small\" />}\n              </IconButton>\n            )}\n            <Box \n              sx={{ \n                display: 'flex', \n                alignItems: 'center', \n                gap: isMobile ? 1 : 1.5,\n                p: isMobile ? 1.25 : 1.5,\n              }}\n            >\n              <Avatar\n                sx={{\n                  width: isMobile ? 38 : 48,\n                  height: isMobile ? 38 : 48,\n                  bgcolor: alpha(bgColor, 0.9),\n                  fontSize: isMobile ? '1rem' : '1.2rem',\n                  fontWeight: 600,\n                }}\n              >\n                {initials}\n              </Avatar>\n              <Box sx={{ minWidth: 0, flex: 1 }}>\n                <Typography \n                  variant={isMobile ? \"body2\" : \"subtitle1\"}\n                  sx={{ \n                    fontWeight: 600,\n                    whiteSpace: 'nowrap',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    fontSize: isMobile ? '0.875rem' : '1rem',\n                    lineHeight: 1.2,\n                    mb: 0.5,\n                    pr: hasChildren ? 3 : 0,\n                    color: muiTheme.palette.text.primary\n                  }}\n                >\n                  {attrs.name}\n                </Typography>\n                <Typography \n                  variant=\"caption\" \n                  sx={{\n                    display: 'block',\n                    whiteSpace: 'nowrap',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    fontSize: isMobile ? '0.75rem' : '0.8125rem',\n                    lineHeight: 1.2,\n                    mb: 0.25,\n                    color: muiTheme.palette.text.secondary,\n                    fontWeight: 500\n                  }}\n                >\n                  {attrs.role}\n                </Typography>\n                <Typography \n                  variant=\"caption\" \n                  sx={{\n                    display: 'block',\n                    whiteSpace: 'nowrap',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    fontSize: isMobile ? '0.75rem' : '0.8125rem',\n                    lineHeight: 1.2,\n                    color: muiTheme.palette.primary.main,\n                    fontWeight: 500\n                  }}\n                >\n                  {attrs.team}\n                </Typography>\n              </Box>\n            </Box>\n          </Card>\n        </foreignObject>\n      </g>\n    );\n  };\n\n  if (!treeData) {\n    return (\n      <Box sx={{ p: 3 }}>\n        <Typography>Loading organization chart...</Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ height: '100vh', p: 3 }}>\n      <Box sx={{ \n        mb: 3,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between'\n      }}>\n        <Typography \n          component=\"h1\" \n          sx={{ \n            fontWeight: headingFontWeights?.pageTitle || 700,\n            fontSize: pageTitleFontSize,\n            fontFamily: headingFont\n          }}\n        >\n          Organization Chart\n        </Typography>\n        <IconButton\n          onClick={toggleAllNodes}\n          sx={{\n            border: `1px solid ${alpha(muiTheme.palette.divider, 0.8)}`,\n            borderRadius: 1,\n            p: 1,\n            color: muiTheme.palette.text.secondary,\n            '&:hover': {\n              bgcolor: alpha(muiTheme.palette.primary.main, 0.08),\n              color: muiTheme.palette.primary.main,\n              borderColor: muiTheme.palette.primary.main,\n            }\n          }}\n        >\n          {isAllExpanded ? <RemoveIcon /> : <AddIcon />}\n        </IconButton>\n      </Box>\n      <Box sx={{ width: '100%', height: 'calc(100vh - 64px)' }}>\n        <Tree\n          data={treeData ? processTreeData(treeData) : { name: 'No Data' }}\n          renderCustomNodeElement={renderCustomNode}\n          orientation=\"vertical\"\n          pathFunc=\"step\"\n          translate={{ \n            x: dimensions.width / 2, \n            y: Math.min(100, dimensions.height * 0.1) \n          }}\n          separation={{ \n            siblings: 2, \n            nonSiblings: 2 \n          }}\n          zoom={0.6}\n          nodeSize={{ \n            x: 300, \n            y: 150 \n          }}\n          enableLegacyTransitions={true}\n          transitionDuration={800}\n          scaleExtent={{ min: 0.1, max: 2 }}\n          hasInteractiveNodes={true}\n        />\n      </Box>\n    </Box>\n  );\n};\n\nexport default OrgChart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}