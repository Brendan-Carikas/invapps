{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport G6 from '@antv/g6';\nimport { clone, deepMix, each, isBoolean, isPlainObject, mix, omit } from '@antv/util';\nimport { defaultCardStyle, defaultLabelStyle, defaultLineLabelStyle, defaultMargin, prefix } from '../../constants';\nimport { cloneBesidesImg, createMarker, getArrowCfg, getCssPadding, getStatusBBox, getStatusCfg, getStyle, setEllipsis, getChildrenData } from '../../utils';\nimport { getGlobalInstance } from '../../utils/global';\nvar getPathInfo = function (cfg) {\n  var edgeCfg = cfg.edgeCfg;\n  var startPoint = cfg.startPoint;\n  var endPoint = cfg.endPoint;\n  var startX = startPoint.x,\n    startY = startPoint.y;\n  var endX = endPoint.x,\n    endY = endPoint.y;\n  var yDiff = endY - startY;\n  var useControlPoint = Math.abs(yDiff) > 0;\n  var line1EndPoint;\n  var line2StartPoint;\n  var controlPoint;\n  var path;\n  if (Math.abs(yDiff) <= 5) {\n    line2StartPoint = {\n      x: startX + 20,\n      y: endY\n    };\n    path = [['M', startX, startY], ['L', endX, endY]];\n  } else {\n    var slope = useControlPoint ? Math.min(500 / Math.abs(yDiff), 20) : 0;\n    var cpOffset = slope > 15 ? 0 : 16;\n    var offset = yDiff < 0 ? cpOffset : -cpOffset;\n    line1EndPoint = {\n      x: startX + slope,\n      y: endY + offset\n    };\n    line2StartPoint = {\n      x: line1EndPoint.x + cpOffset,\n      y: endY\n    };\n    // 控制点坐标\n    controlPoint = {\n      x: (line1EndPoint.x - startX) * (endY - startY) / (line1EndPoint.y - startY) + startX,\n      y: endY\n    };\n    path = [['M', startX, startY], ['L', line1EndPoint.x, line1EndPoint.y], ['Q', controlPoint.x, controlPoint.y, line2StartPoint.x, line2StartPoint.y], ['L', endX, endY]];\n  }\n  var _a = edgeCfg,\n    startArrowCfg = _a.startArrow,\n    endArrowCfg = _a.endArrow;\n  var startArrow = getArrowCfg(startArrowCfg, cfg);\n  var endArrow = getArrowCfg(endArrowCfg, cfg);\n  return {\n    startArrow: startArrow,\n    endArrow: endArrow,\n    path: path,\n    line2StartPoint: line2StartPoint,\n    endY: endY\n  };\n};\nvar getPathText = function (value) {\n  var text;\n  var subText;\n  if (value instanceof Object) {\n    text = value.text;\n    subText = value.subText;\n  } else {\n    text = value;\n  }\n  return {\n    text: text,\n    subText: subText\n  };\n};\n// 通用指标卡\nexport var registerIndicatorGeometries = function () {\n  var defaultTitleLabelStyle = {\n    fill: '#fff',\n    fontSize: 12\n  };\n  var defaultTitleRectStyle = {\n    fill: '#40a9ff',\n    radius: [2, 2, 0, 0]\n  };\n  var defaultIconStyle = {\n    width: 12,\n    height: 12\n  };\n  var ARROWS = ['startArrow', 'endArrow'];\n  var SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: undefined,\n    fill: undefined,\n    lineAppendWidth: 1,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    x: 0,\n    y: 0,\n    r: 10,\n    width: 20,\n    height: 20,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var PATH_SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: '#000',\n    lineDash: undefined,\n    startArrow: false,\n    endArrow: false,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var SHAPES_DEFAULT_ATTRS = {\n    edge: PATH_SHAPE_DEFAULT_ATTRS,\n    node: SHAPE_DEFAULT_ATTRS\n  };\n  // 注册节点\n  G6.registerNode('indicator-card', {\n    // @ts-ignore\n    draw: function (cfg, group) {\n      var _a, _b, _c;\n      if (cfg === void 0) {\n        cfg = {};\n      }\n      var _d = cfg.value,\n        value = _d === void 0 ? {} : _d,\n        nodeCfg = cfg.nodeCfg,\n        markerCfg = cfg.markerCfg,\n        draggable = cfg._draggable;\n      var _e = nodeCfg,\n        titleCfg = _e.title,\n        itemsCfg = _e.items,\n        _f = _e.label,\n        label = _f === void 0 ? {} : _f,\n        style = _e.style,\n        _g = _e.padding,\n        padding = _g === void 0 ? 0 : _g,\n        badge = _e.badge,\n        percent = _e.percent,\n        autoWidth = _e.autoWidth,\n        customContent = _e.customContent;\n      var appendPadding = getStatusBBox(badge);\n      var labelStyle = label.style;\n      var cardPadding = getCssPadding(padding);\n      var paddingArray = cardPadding.map(function (item, index) {\n        return item + appendPadding[index];\n      });\n      var _h = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {},\n        titleStyle = _h.style,\n        titleContainerStyle = _h.containerStyle,\n        _j = _h.autoEllipsis,\n        autoEllipsis = _j === void 0 ? true : _j;\n      var _k = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {},\n        itemStyle = _k.style,\n        itemContainerStyle = _k.containerStyle,\n        layout = _k.layout,\n        _l = _k.itemSpacing,\n        itemSpacing = _l === void 0 ? 4 : _l,\n        sort = _k.sort,\n        _m = _k.padding,\n        itemPadding = _m === void 0 ? [6, 0, 0] : _m;\n      var itemPaddingArray = getCssPadding(itemPadding);\n      var _o = value,\n        title = _o.title,\n        items = _o.items,\n        percentValue = _o.percent;\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置\n      var shapeWidth = size[0];\n      var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\n      // card box\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: draggable\n      });\n      // node title\n      var titleTextShape;\n      var itemShape;\n      var titleShape;\n      if (title) {\n        // title rect\n        titleShape = group.addShape('rect', {\n          attrs: __assign(__assign({\n            x: 0,\n            y: 0,\n            width: size[0],\n            height: 0\n          }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n          name: 'title-rect',\n          draggable: draggable\n        });\n        var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n        titleTextShape = group.addShape('text', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: paddingArray[0],\n            textBaseline: 'top',\n            text: autoEllipsis && !autoWidth ? setEllipsis(title, textStyle, contentWidth) : title\n          }, textStyle),\n          name: 'title',\n          draggable: draggable\n        });\n        var titleHeight_1 = (titleTextShape ? titleTextShape.getBBox() : {\n          height: size[1] / 2\n        }).height;\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n        height += titleShape.getBBox().height;\n      }\n      if (items) {\n        if (!titleShape) {\n          height += paddingArray[0];\n        }\n        itemShape = group.addShape('rect', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: height,\n            width: contentWidth,\n            height: 0\n          }, getStyle(itemContainerStyle, cfg, group)),\n          name: 'item-box',\n          draggable: draggable\n        });\n        height += itemPaddingArray[0];\n        var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n        var isArray_1 = Array.isArray(items);\n        var createRowItems_1 = function (item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n          var rowHeight = [];\n          var valueShapeWidth = 0;\n          var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n          keys.forEach(function (key, keyIndex) {\n            var x;\n            var isIcon = key.startsWith('icon');\n            // sort 直接均分，简单化\n            if (sort || layout === 'flex') {\n              x = keyIndex * contentWidth / keys.length;\n            } else if (layout === 'follow') {\n              x = valueShapeWidth;\n            } else {\n              // layout === 'bundled'\n              // 直接均分，icon 紧随 value\n              x = key === 'text' ? 0 : contentWidth / 2;\n              x += isIcon ? valueShapeWidth : 0;\n            }\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign({\n                textBaseline: 'top',\n                x: startX + x,\n                y: height,\n                text: item[key],\n                img: item[key]\n              }, isIcon ? defaultIconStyle : defaultLabelStyle), isIcon ? omit(getStyle(itemStyle || labelStyle, cfg, group, key), ['fill']) : getStyle(itemStyle || labelStyle, cfg, group, key)),\n              name: \"\".concat(key, \"-\").concat(index, \"-\").concat(keyIndex),\n              draggable: draggable\n            });\n            if (key === 'value' || layout === 'follow') {\n              valueShapeWidth += keyShape.getBBox().width;\n              valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n            }\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n        var createItems_1 = function (item, index) {\n          var _a;\n          if (index === void 0) {\n            index = 0;\n          }\n          var itemsHeight = [];\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3] + itemPaddingArray[3],\n              startY: height,\n              width: itemContentWidth_1\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n          }\n          height += Math.max.apply(Math, itemsHeight);\n          if (isArray_1 && index !== items.length - 1) {\n            height += defaultMargin;\n          }\n        };\n        if (Array.isArray(items)) {\n          items.forEach(function (item, index) {\n            createItems_1(item, index);\n          });\n        } else {\n          createItems_1(items);\n        }\n      }\n      var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n      itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n      var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n      var shapeHeight = items ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2] : titleHeight + itemHeight;\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n      var outerMaxX = shapeWidth;\n      if (autoWidth) {\n        var shapeMaxX = Math.max.apply(null, (_a = group === null || group === void 0 ? void 0 : group.getChildren()) === null || _a === void 0 ? void 0 : _a.map(function (childrenShape) {\n          return childrenShape.getBBox().maxX || 0;\n        }));\n        outerMaxX = Math.max(shapeWidth, shapeMaxX + paddingArray[1]);\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('width', outerMaxX);\n        shape === null || shape === void 0 ? void 0 : shape.attr('width', outerMaxX);\n        itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('width', shapeMaxX - paddingArray[1]);\n      }\n      if (badge) {\n        var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n        group.addShape('rect', {\n          attrs: __assign(__assign({\n            fill: '#40a9ff'\n          }, statusConfig), getStyle(badge.style, cfg, group)),\n          name: 'status-rect',\n          draggable: draggable\n        });\n      }\n      if (percent && percentValue > 0) {\n        var _p = percent.size,\n          percentSize = _p === void 0 ? 4 : _p,\n          _q = percent.position,\n          position = _q === void 0 ? 'bottom' : _q,\n          _r = percent.style,\n          percentStyle = _r === void 0 ? {\n            fill: '#40a9ff'\n          } : _r,\n          _s = percent.backgroundStyle,\n          backgroundStyle = _s === void 0 ? {\n            fill: 'rgba(0,0,0,.1)',\n            radius: [0, 0, 2, 2]\n          } : _s;\n        var statusConfig = getStatusCfg({\n          position: position,\n          size: [outerMaxX, percentSize]\n        }, [outerMaxX, shapeHeight]);\n        group.addShape('rect', {\n          attrs: __assign(__assign({}, statusConfig), getStyle(backgroundStyle, cfg, group)),\n          name: 'percent-rect-background',\n          draggable: draggable\n        });\n        group.addShape('rect', {\n          attrs: __assign(__assign(__assign({\n            fill: '#40a9ff'\n          }, statusConfig), {\n            width: Math.min(1, percentValue) * statusConfig.width\n          }), getStyle(percentStyle, cfg, group)),\n          name: 'percent-rect',\n          draggable: draggable\n        });\n      }\n      // collapse marker\n      if (markerCfg) {\n        var graph = getGlobalInstance(cfg._graphId);\n        var stateCollapsed_1 = ((_c = (_b = group === null || group === void 0 ? void 0 : group.get('item')) === null || _b === void 0 ? void 0 : _b.getModel()) !== null && _c !== void 0 ? _c : {}).collapsed;\n        var _t = shape.getBBox(),\n          shapeWidth_1 = _t.width,\n          shapeHeight_1 = _t.height;\n        var markerCfgArray_1 = [];\n        if (typeof markerCfg === 'function') {\n          var callbackMarkerCfg = markerCfg(__assign(__assign({}, cfg), {\n            children: getChildrenData(graph === null || graph === void 0 ? void 0 : graph.get('eventData').getData(), cfg.g_currentPath)\n          }), group);\n          markerCfgArray_1 = callbackMarkerCfg instanceof Array ? callbackMarkerCfg : [callbackMarkerCfg];\n        } else {\n          markerCfgArray_1 = markerCfg instanceof Array ? markerCfg : [markerCfg];\n        }\n        var getCollapsed_1 = function () {\n          var _a, _b;\n          if (isBoolean(stateCollapsed_1)) return stateCollapsed_1;\n          if (cfg._graphId.startsWith('FlowAnalysisGraph')) return !((_a = cfg[\"\".concat(prefix, \"_children\")]) === null || _a === void 0 ? void 0 : _a.length);\n          return !((_b = cfg.children) === null || _b === void 0 ? void 0 : _b.length);\n        };\n        markerCfgArray_1.forEach(function (mc) {\n          var show = mc.show,\n            _a = mc.position,\n            position = _a === void 0 ? 'right' : _a,\n            inCollapsed = mc.collapsed,\n            markerStyle = mc.style;\n          var collapsed = inCollapsed !== null && inCollapsed !== void 0 ? inCollapsed : getCollapsed_1();\n          createMarker({\n            show: show,\n            position: position,\n            collapsed: collapsed,\n            style: markerStyle\n          }, group, [shapeWidth_1, shapeHeight_1], markerCfgArray_1.length > 1);\n          shape.attr('defaultCollapsed', collapsed);\n        });\n      }\n      return shape;\n    },\n    /**\n     * 更新节点，包含文本\n     * @override\n     * @param  {Object} cfg 节点的配置项\n     * @param  {Node} node 节点\n     */\n    // @ts-ignore\n    update: undefined,\n    // @ts-ignore\n    setState: function (name, value, item) {\n      var _a, _b;\n      var shape = item.get('keyShape');\n      if (!shape || shape.destroyed) return;\n      var type = item.getType();\n      var stateName = isBoolean(value) ? name : \"\".concat(name, \":\").concat(value);\n      var itemStateStyle = item.getStateStyle(stateName);\n      // const originStyle = item.getOriginStyle();\n      // 不允许设置一个不存在的状态\n      if (!itemStateStyle) {\n        return;\n      }\n      // 要设置或取消的状态的样式\n      // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n      var styles = Object.assign({}, itemStateStyle);\n      var group = item.getContainer();\n      // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n      var keptAttrs = {\n        x: 1,\n        y: 1,\n        cx: 1,\n        cy: 1\n      };\n      if (value) {\n        var _loop_1 = function (key) {\n          var _c;\n          var style = styles[key];\n          if (isPlainObject(style) && !ARROWS.includes(key)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === key;\n            });\n            if (subShape) {\n              subShape.attr(style);\n            }\n          } else {\n            // 非纯对象，则认为是设置到 keyShape 上面的\n            shape.attr((_c = {}, _c[key] = style, _c));\n          }\n        };\n        // style 为要设置的状态的样式\n        for (var key in styles) {\n          _loop_1(key);\n        }\n      } else {\n        // 所有生效的 state 的样式\n        var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n        var model = item.getModel();\n        // 原始样式\n        var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n        var keyShapeName_1 = shape.get('name');\n        // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n        // const keyShapeStyles = clone(shape.attr())\n        var shapeAttrs_1 = shape.attr();\n        var keyShapeStyles_1 = {};\n        Object.keys(shapeAttrs_1).forEach(function (key) {\n          if (key === 'img') return;\n          var attr = shapeAttrs_1[key];\n          if (attr && typeof attr === 'object') {\n            keyShapeStyles_1[key] = clone(attr);\n          } else {\n            keyShapeStyles_1[key] = attr;\n          }\n        });\n        // 已有样式 - 要取消的状态的样式\n        var filtetDisableStatesStyle = {};\n        var _loop_2 = function (p) {\n          var style = styles[p];\n          if (isPlainObject(style) && !ARROWS.includes(p)) {\n            var subShape_1 = group.find(function (element) {\n              return element.get('name') === p;\n            });\n            if (subShape_1) {\n              var subShapeStyles_1 = clone(subShape_1.attr());\n              each(style, function (v, key) {\n                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                  delete keyShapeStyles_1[key];\n                  var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  shape.attr(key, value_1);\n                } else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                  delete subShapeStyles_1[key];\n                  var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  subShape_1.attr(key, value_2);\n                }\n              });\n              filtetDisableStatesStyle[p] = subShapeStyles_1;\n            }\n          } else {\n            if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n              delete keyShapeStyles_1[p];\n              var value_3 = originStyle_1[p] || (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) || SHAPES_DEFAULT_ATTRS[type][p];\n              shape.attr(p, value_3);\n            }\n          }\n        };\n        // styles 为要取消的状态的样式\n        for (var p in styles) {\n          _loop_2(p);\n        }\n        // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n        // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n        // 否则为普通对象\n        if (!keyShapeName_1) {\n          mix(filtetDisableStatesStyle, keyShapeStyles_1);\n        } else {\n          filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n        }\n        for (var key in enableStatesStyle) {\n          if (keptAttrs[key]) continue;\n          var enableStyle = enableStatesStyle[key];\n          if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n            // 把样式属性merge到keyShape中\n            if (!keyShapeName_1) {\n              mix(originStyle_1, (_a = {}, _a[key] = enableStyle, _a));\n            } else {\n              mix(originStyle_1[keyShapeName_1], (_b = {}, _b[key] = enableStyle, _b));\n              delete originStyle_1[key];\n            }\n            delete enableStatesStyle[key];\n          }\n        }\n        var originstyles = {};\n        deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n        var keyShapeSetted = false;\n        var _loop_3 = function (originKey) {\n          var _d;\n          var style = originstyles[originKey];\n          if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === originKey;\n            });\n            if (subShape) {\n              if (originKey === keyShapeName_1) {\n                keyShapeSetted = true;\n              }\n              if (originKey !== 'collapse-icon') subShape.attr(style);\n            }\n          } else if (!keyShapeSetted) {\n            var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n            shape.attr((_d = {}, _d[originKey] = value_4, _d));\n          }\n        };\n        for (var originKey in originstyles) {\n          _loop_3(originKey);\n        }\n      }\n    }\n  }, 'single-node');\n  // 注册边\n  G6.registerEdge('labels-line', {\n    // @ts-ignore\n    draw: function draw(cfg, group) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n      var edgeCfg = cfg.edgeCfg,\n        value = cfg.value;\n      var _a = getPathText(value),\n        text = _a.text,\n        subText = _a.subText;\n      var _b = edgeCfg,\n        edgeStyle = _b.style,\n        labelCfg = _b.label;\n      var _c = getPathInfo(cfg),\n        startArrow = _c.startArrow,\n        endArrow = _c.endArrow,\n        path = _c.path,\n        line2StartPoint = _c.line2StartPoint,\n        endY = _c.endY;\n      var _d = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {},\n        labelStyle = _d.style,\n        _e = _d.margin,\n        margin = _e === void 0 ? 4 : _e;\n      var line = group.addShape('path', {\n        attrs: __assign({\n          path: path,\n          stroke: '#ccc',\n          startArrow: startArrow,\n          endArrow: endArrow\n        }, typeof edgeStyle === 'function' ? edgeStyle(cfg, group) : edgeStyle),\n        name: 'path-shape'\n      });\n      var createItem = function (itemText, key, attrs) {\n        group.addShape('text', {\n          attrs: __assign({\n            text: itemText,\n            x: line2StartPoint.x\n          }, attrs),\n          name: \"line-text-\".concat(key)\n        });\n      };\n      if (text) {\n        var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, 'text'));\n        var offsetY = subText ? Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2 : 0;\n        createItem(text, 'text', __assign({\n          y: endY - offsetY - margin / 2\n        }, textStyle));\n      }\n      if (subText) {\n        var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, 'subText'));\n        var offsetY = Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2;\n        createItem(text, 'subText', __assign({\n          y: endY + offsetY + margin / 2\n        }, textStyle));\n      }\n      return line;\n    },\n    // @ts-ignore\n    update: function (cfg, edge) {\n      var edgeCfg = cfg.edgeCfg,\n        value = cfg.value;\n      var _a = getPathText(value),\n        text = _a.text,\n        subText = _a.subText;\n      var group = edge.getContainer();\n      var getShape = function (shapeName) {\n        return group.get('children').find(function (item) {\n          return item.get('name') === shapeName;\n        });\n      };\n      var _b = getPathInfo(cfg),\n        startArrow = _b.startArrow,\n        endArrow = _b.endArrow,\n        path = _b.path,\n        line2StartPoint = _b.line2StartPoint,\n        endY = _b.endY;\n      var _c = edgeCfg,\n        edgeStyle = _c.style,\n        labelCfg = _c.label;\n      var _d = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {},\n        labelStyle = _d.style,\n        _e = _d.margin,\n        margin = _e === void 0 ? 4 : _e;\n      // path\n      var pathShape = getShape('path-shape');\n      pathShape === null || pathShape === void 0 ? void 0 : pathShape.attr(__assign({\n        path: path,\n        stroke: '#ccc',\n        startArrow: startArrow,\n        endArrow: endArrow\n      }, typeof edgeStyle === 'function' ? edgeStyle(cfg, group) : edgeStyle));\n      // path text\n      var texts = ['text', 'subText'];\n      var hasSubText = !!getShape(\"line-text-subText\");\n      texts.forEach(function (key) {\n        var textShape = getShape(\"line-text-\".concat(key));\n        var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, key));\n        var offsetY = hasSubText ? Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2 : 0;\n        textShape === null || textShape === void 0 ? void 0 : textShape.attr(__assign({\n          x: line2StartPoint.x,\n          y: key === 'text' ? endY - offsetY - margin / 2 : endY + offsetY + margin / 2,\n          text: key === 'text' ? text : subText\n        }, textStyle));\n      });\n    }\n  }, 'single-edge');\n};","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","clone","deepMix","each","isBoolean","isPlainObject","mix","omit","defaultCardStyle","defaultLabelStyle","defaultLineLabelStyle","defaultMargin","prefix","cloneBesidesImg","createMarker","getArrowCfg","getCssPadding","getStatusBBox","getStatusCfg","getStyle","setEllipsis","getChildrenData","getGlobalInstance","getPathInfo","cfg","edgeCfg","startPoint","endPoint","startX","x","startY","y","endX","endY","yDiff","useControlPoint","Math","abs","line1EndPoint","line2StartPoint","controlPoint","path","slope","min","cpOffset","offset","_a","startArrowCfg","startArrow","endArrowCfg","endArrow","getPathText","value","text","subText","registerIndicatorGeometries","defaultTitleLabelStyle","fill","fontSize","defaultTitleRectStyle","radius","defaultIconStyle","width","height","ARROWS","SHAPE_DEFAULT_ATTRS","lineWidth","stroke","undefined","lineAppendWidth","opacity","strokeOpacity","fillOpacity","r","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","PATH_SHAPE_DEFAULT_ATTRS","lineDash","SHAPES_DEFAULT_ATTRS","edge","node","registerNode","draw","group","_b","_c","_d","nodeCfg","markerCfg","draggable","_draggable","_e","titleCfg","title","itemsCfg","items","_f","label","style","_g","padding","badge","percent","autoWidth","customContent","appendPadding","labelStyle","cardPadding","paddingArray","map","item","index","_h","titleStyle","titleContainerStyle","containerStyle","_j","autoEllipsis","_k","itemStyle","itemContainerStyle","layout","_l","itemSpacing","sort","_m","itemPadding","itemPaddingArray","_o","percentValue","size","shapeWidth","contentWidth","cardStyle","shape","addShape","attrs","name","titleTextShape","itemShape","titleShape","textStyle","textBaseline","titleHeight_1","getBBox","attr","itemContentWidth_1","isArray_1","Array","isArray","createRowItems_1","rowHeight","valueShapeWidth","keys","forEach","key","keyIndex","isIcon","startsWith","keyShape","img","concat","push","createItems_1","itemsHeight","max","titleHeight","itemHeight","shapeHeight","outerMaxX","shapeMaxX","getChildren","childrenShape","maxX","statusConfig","_p","percentSize","_q","position","_r","percentStyle","_s","backgroundStyle","graph","_graphId","stateCollapsed_1","get","getModel","collapsed","_t","shapeWidth_1","shapeHeight_1","markerCfgArray_1","callbackMarkerCfg","children","getData","g_currentPath","getCollapsed_1","mc","show","inCollapsed","markerStyle","update","setState","destroyed","type","getType","stateName","itemStateStyle","getStateStyle","styles","getContainer","keptAttrs","cx","cy","_loop_1","includes","subShape","find","element","enableStatesStyle","getCurrentStatesStyle","model","originStyle_1","getOriginStyle","keyShapeName_1","shapeAttrs_1","keyShapeStyles_1","filtetDisableStatesStyle","_loop_2","subShape_1","subShapeStyles_1","v","value_1","value_2","value_3","enableStyle","originstyles","keyShapeSetted","_loop_3","originKey","value_4","registerEdge","edgeStyle","labelCfg","margin","line","createItem","itemText","offsetY","Number","replace","getShape","shapeName","pathShape","texts","hasSubText","textShape"],"sources":["/Users/invotradesign/CascadeProjects/site-users-app/node_modules/@ant-design/graphs/es/components/flow-analysis-graph/customItem.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport G6 from '@antv/g6';\nimport { clone, deepMix, each, isBoolean, isPlainObject, mix, omit } from '@antv/util';\nimport { defaultCardStyle, defaultLabelStyle, defaultLineLabelStyle, defaultMargin, prefix } from '../../constants';\nimport { cloneBesidesImg, createMarker, getArrowCfg, getCssPadding, getStatusBBox, getStatusCfg, getStyle, setEllipsis, getChildrenData, } from '../../utils';\nimport { getGlobalInstance } from '../../utils/global';\nvar getPathInfo = function (cfg) {\n    var edgeCfg = cfg.edgeCfg;\n    var startPoint = cfg.startPoint;\n    var endPoint = cfg.endPoint;\n    var startX = startPoint.x, startY = startPoint.y;\n    var endX = endPoint.x, endY = endPoint.y;\n    var yDiff = endY - startY;\n    var useControlPoint = Math.abs(yDiff) > 0;\n    var line1EndPoint;\n    var line2StartPoint;\n    var controlPoint;\n    var path;\n    if (Math.abs(yDiff) <= 5) {\n        line2StartPoint = {\n            x: startX + 20,\n            y: endY,\n        };\n        path = [\n            ['M', startX, startY],\n            ['L', endX, endY],\n        ];\n    }\n    else {\n        var slope = useControlPoint ? Math.min(500 / Math.abs(yDiff), 20) : 0;\n        var cpOffset = slope > 15 ? 0 : 16;\n        var offset = yDiff < 0 ? cpOffset : -cpOffset;\n        line1EndPoint = {\n            x: startX + slope,\n            y: endY + offset,\n        };\n        line2StartPoint = {\n            x: line1EndPoint.x + cpOffset,\n            y: endY,\n        };\n        // 控制点坐标\n        controlPoint = {\n            x: ((line1EndPoint.x - startX) * (endY - startY)) / (line1EndPoint.y - startY) + startX,\n            y: endY,\n        };\n        path = [\n            ['M', startX, startY],\n            ['L', line1EndPoint.x, line1EndPoint.y],\n            ['Q', controlPoint.x, controlPoint.y, line2StartPoint.x, line2StartPoint.y],\n            ['L', endX, endY],\n        ];\n    }\n    var _a = edgeCfg, startArrowCfg = _a.startArrow, endArrowCfg = _a.endArrow;\n    var startArrow = getArrowCfg(startArrowCfg, cfg);\n    var endArrow = getArrowCfg(endArrowCfg, cfg);\n    return {\n        startArrow: startArrow,\n        endArrow: endArrow,\n        path: path,\n        line2StartPoint: line2StartPoint,\n        endY: endY,\n    };\n};\nvar getPathText = function (value) {\n    var text;\n    var subText;\n    if (value instanceof Object) {\n        text = value.text;\n        subText = value.subText;\n    }\n    else {\n        text = value;\n    }\n    return { text: text, subText: subText };\n};\n// 通用指标卡\nexport var registerIndicatorGeometries = function () {\n    var defaultTitleLabelStyle = {\n        fill: '#fff',\n        fontSize: 12,\n    };\n    var defaultTitleRectStyle = {\n        fill: '#40a9ff',\n        radius: [2, 2, 0, 0],\n    };\n    var defaultIconStyle = {\n        width: 12,\n        height: 12,\n    };\n    var ARROWS = ['startArrow', 'endArrow'];\n    var SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: undefined,\n        fill: undefined,\n        lineAppendWidth: 1,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        x: 0,\n        y: 0,\n        r: 10,\n        width: 20,\n        height: 20,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var PATH_SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: '#000',\n        lineDash: undefined,\n        startArrow: false,\n        endArrow: false,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var SHAPES_DEFAULT_ATTRS = {\n        edge: PATH_SHAPE_DEFAULT_ATTRS,\n        node: SHAPE_DEFAULT_ATTRS,\n    };\n    // 注册节点\n    G6.registerNode('indicator-card', {\n        // @ts-ignore\n        draw: function (cfg, group) {\n            var _a, _b, _c;\n            if (cfg === void 0) { cfg = {}; }\n            var _d = cfg.value, value = _d === void 0 ? {} : _d, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg, draggable = cfg._draggable;\n            var _e = nodeCfg, titleCfg = _e.title, itemsCfg = _e.items, _f = _e.label, label = _f === void 0 ? {} : _f, style = _e.style, _g = _e.padding, padding = _g === void 0 ? 0 : _g, badge = _e.badge, percent = _e.percent, autoWidth = _e.autoWidth, customContent = _e.customContent;\n            var appendPadding = getStatusBBox(badge);\n            var labelStyle = label.style;\n            var cardPadding = getCssPadding(padding);\n            var paddingArray = cardPadding.map(function (item, index) { return item + appendPadding[index]; });\n            var _h = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {}, titleStyle = _h.style, titleContainerStyle = _h.containerStyle, _j = _h.autoEllipsis, autoEllipsis = _j === void 0 ? true : _j;\n            var _k = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {}, itemStyle = _k.style, itemContainerStyle = _k.containerStyle, layout = _k.layout, _l = _k.itemSpacing, itemSpacing = _l === void 0 ? 4 : _l, sort = _k.sort, _m = _k.padding, itemPadding = _m === void 0 ? [6, 0, 0] : _m;\n            var itemPaddingArray = getCssPadding(itemPadding);\n            var _o = value, title = _o.title, items = _o.items, percentValue = _o.percent;\n            var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n            if (typeof size === 'number')\n                size = [size, size];\n            var height = 0; // 统计容器总高度，动态设置\n            var shapeWidth = size[0];\n            var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\n            // card box\n            var cardStyle = getStyle(style, cfg, group);\n            var shape = group.addShape('rect', {\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\n                name: 'main-box',\n                draggable: draggable,\n            });\n            // node title\n            var titleTextShape;\n            var itemShape;\n            var titleShape;\n            if (title) {\n                // title rect\n                titleShape = group.addShape('rect', {\n                    attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: 0 }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n                    name: 'title-rect',\n                    draggable: draggable,\n                });\n                var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n                titleTextShape = group.addShape('text', {\n                    attrs: __assign({ x: paddingArray[3], y: paddingArray[0], textBaseline: 'top', text: autoEllipsis && !autoWidth ? setEllipsis(title, textStyle, contentWidth) : title }, textStyle),\n                    name: 'title',\n                    draggable: draggable,\n                });\n                var titleHeight_1 = (titleTextShape ? titleTextShape.getBBox() : { height: size[1] / 2 }).height;\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n                height += titleShape.getBBox().height;\n            }\n            if (items) {\n                if (!titleShape) {\n                    height += paddingArray[0];\n                }\n                itemShape = group.addShape('rect', {\n                    attrs: __assign({ x: paddingArray[3], y: height, width: contentWidth, height: 0 }, getStyle(itemContainerStyle, cfg, group)),\n                    name: 'item-box',\n                    draggable: draggable,\n                });\n                height += itemPaddingArray[0];\n                var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n                var isArray_1 = Array.isArray(items);\n                var createRowItems_1 = function (item, contentWidth, startX, index) {\n                    if (index === void 0) { index = 0; }\n                    var rowHeight = [];\n                    var valueShapeWidth = 0;\n                    var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n                    keys.forEach(function (key, keyIndex) {\n                        var x;\n                        var isIcon = key.startsWith('icon');\n                        // sort 直接均分，简单化\n                        if (sort || layout === 'flex') {\n                            x = (keyIndex * contentWidth) / keys.length;\n                        }\n                        else if (layout === 'follow') {\n                            x = valueShapeWidth;\n                        }\n                        else {\n                            // layout === 'bundled'\n                            // 直接均分，icon 紧随 value\n                            x = key === 'text' ? 0 : contentWidth / 2;\n                            x += isIcon ? valueShapeWidth : 0;\n                        }\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n                            attrs: __assign(__assign({ textBaseline: 'top', x: startX + x, y: height, text: item[key], img: item[key] }, (isIcon ? defaultIconStyle : defaultLabelStyle)), (isIcon\n                                ? omit(getStyle(itemStyle || labelStyle, cfg, group, key), ['fill'])\n                                : getStyle(itemStyle || labelStyle, cfg, group, key))),\n                            name: \"\".concat(key, \"-\").concat(index, \"-\").concat(keyIndex),\n                            draggable: draggable,\n                        });\n                        if (key === 'value' || layout === 'follow') {\n                            valueShapeWidth += keyShape.getBBox().width;\n                            valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n                        }\n                        rowHeight.push(keyShape.getBBox().height);\n                    });\n                    return rowHeight;\n                };\n                var createItems_1 = function (item, index) {\n                    var _a;\n                    if (index === void 0) { index = 0; }\n                    var itemsHeight = [];\n                    if (customContent) {\n                        itemsHeight.push((_a = customContent(item, group, {\n                            startX: paddingArray[3] + itemPaddingArray[3],\n                            startY: height,\n                            width: itemContentWidth_1,\n                        })) !== null && _a !== void 0 ? _a : 0);\n                    }\n                    else {\n                        itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n                    }\n                    height += Math.max.apply(Math, itemsHeight);\n                    if (isArray_1 && index !== items.length - 1) {\n                        height += defaultMargin;\n                    }\n                };\n                if (Array.isArray(items)) {\n                    items.forEach(function (item, index) {\n                        createItems_1(item, index);\n                    });\n                }\n                else {\n                    createItems_1(items);\n                }\n            }\n            var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n            itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n            var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n            var shapeHeight = items\n                ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2]\n                : titleHeight + itemHeight;\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n            var outerMaxX = shapeWidth;\n            if (autoWidth) {\n                var shapeMaxX = Math.max.apply(null, (_a = group === null || group === void 0 ? void 0 : group.getChildren()) === null || _a === void 0 ? void 0 : _a.map(function (childrenShape) {\n                    return childrenShape.getBBox().maxX || 0;\n                }));\n                outerMaxX = Math.max(shapeWidth, shapeMaxX + paddingArray[1]);\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('width', outerMaxX);\n                shape === null || shape === void 0 ? void 0 : shape.attr('width', outerMaxX);\n                itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('width', shapeMaxX - paddingArray[1]);\n            }\n            if (badge) {\n                var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n                group.addShape('rect', {\n                    attrs: __assign(__assign({ fill: '#40a9ff' }, statusConfig), getStyle(badge.style, cfg, group)),\n                    name: 'status-rect',\n                    draggable: draggable,\n                });\n            }\n            if (percent && percentValue > 0) {\n                var _p = percent.size, percentSize = _p === void 0 ? 4 : _p, _q = percent.position, position = _q === void 0 ? 'bottom' : _q, _r = percent.style, percentStyle = _r === void 0 ? {\n                    fill: '#40a9ff',\n                } : _r, _s = percent.backgroundStyle, backgroundStyle = _s === void 0 ? {\n                    fill: 'rgba(0,0,0,.1)',\n                    radius: [0, 0, 2, 2],\n                } : _s;\n                var statusConfig = getStatusCfg({\n                    position: position,\n                    size: [outerMaxX, percentSize],\n                }, [outerMaxX, shapeHeight]);\n                group.addShape('rect', {\n                    attrs: __assign(__assign({}, statusConfig), getStyle(backgroundStyle, cfg, group)),\n                    name: 'percent-rect-background',\n                    draggable: draggable,\n                });\n                group.addShape('rect', {\n                    attrs: __assign(__assign(__assign({ fill: '#40a9ff' }, statusConfig), { width: Math.min(1, percentValue) * statusConfig.width }), getStyle(percentStyle, cfg, group)),\n                    name: 'percent-rect',\n                    draggable: draggable,\n                });\n            }\n            // collapse marker\n            if (markerCfg) {\n                var graph = getGlobalInstance(cfg._graphId);\n                var stateCollapsed_1 = ((_c = (_b = group === null || group === void 0 ? void 0 : group.get('item')) === null || _b === void 0 ? void 0 : _b.getModel()) !== null && _c !== void 0 ? _c : {}).collapsed;\n                var _t = shape.getBBox(), shapeWidth_1 = _t.width, shapeHeight_1 = _t.height;\n                var markerCfgArray_1 = [];\n                if (typeof markerCfg === 'function') {\n                    var callbackMarkerCfg = markerCfg(__assign(__assign({}, cfg), { children: getChildrenData(graph === null || graph === void 0 ? void 0 : graph.get('eventData').getData(), cfg.g_currentPath) }), group);\n                    markerCfgArray_1 = callbackMarkerCfg instanceof Array ? callbackMarkerCfg : [callbackMarkerCfg];\n                }\n                else {\n                    markerCfgArray_1 = markerCfg instanceof Array ? markerCfg : [markerCfg];\n                }\n                var getCollapsed_1 = function () {\n                    var _a, _b;\n                    if (isBoolean(stateCollapsed_1))\n                        return stateCollapsed_1;\n                    if (cfg._graphId.startsWith('FlowAnalysisGraph'))\n                        return !((_a = cfg[\"\".concat(prefix, \"_children\")]) === null || _a === void 0 ? void 0 : _a.length);\n                    return !((_b = cfg.children) === null || _b === void 0 ? void 0 : _b.length);\n                };\n                markerCfgArray_1.forEach(function (mc) {\n                    var show = mc.show, _a = mc.position, position = _a === void 0 ? 'right' : _a, inCollapsed = mc.collapsed, markerStyle = mc.style;\n                    var collapsed = inCollapsed !== null && inCollapsed !== void 0 ? inCollapsed : getCollapsed_1();\n                    createMarker({\n                        show: show,\n                        position: position,\n                        collapsed: collapsed,\n                        style: markerStyle,\n                    }, group, [shapeWidth_1, shapeHeight_1], markerCfgArray_1.length > 1);\n                    shape.attr('defaultCollapsed', collapsed);\n                });\n            }\n            return shape;\n        },\n        /**\n         * 更新节点，包含文本\n         * @override\n         * @param  {Object} cfg 节点的配置项\n         * @param  {Node} node 节点\n         */\n        // @ts-ignore\n        update: undefined,\n        // @ts-ignore\n        setState: function (name, value, item) {\n            var _a, _b;\n            var shape = item.get('keyShape');\n            if (!shape || shape.destroyed)\n                return;\n            var type = item.getType();\n            var stateName = isBoolean(value) ? name : \"\".concat(name, \":\").concat(value);\n            var itemStateStyle = item.getStateStyle(stateName);\n            // const originStyle = item.getOriginStyle();\n            // 不允许设置一个不存在的状态\n            if (!itemStateStyle) {\n                return;\n            }\n            // 要设置或取消的状态的样式\n            // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n            var styles = Object.assign({}, itemStateStyle);\n            var group = item.getContainer();\n            // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n            var keptAttrs = { x: 1, y: 1, cx: 1, cy: 1 };\n            if (value) {\n                var _loop_1 = function (key) {\n                    var _c;\n                    var style = styles[key];\n                    if (isPlainObject(style) && !ARROWS.includes(key)) {\n                        var subShape = group.find(function (element) { return element.get('name') === key; });\n                        if (subShape) {\n                            subShape.attr(style);\n                        }\n                    }\n                    else {\n                        // 非纯对象，则认为是设置到 keyShape 上面的\n                        shape.attr((_c = {},\n                            _c[key] = style,\n                            _c));\n                    }\n                };\n                // style 为要设置的状态的样式\n                for (var key in styles) {\n                    _loop_1(key);\n                }\n            }\n            else {\n                // 所有生效的 state 的样式\n                var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n                var model = item.getModel();\n                // 原始样式\n                var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n                var keyShapeName_1 = shape.get('name');\n                // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n                // const keyShapeStyles = clone(shape.attr())\n                var shapeAttrs_1 = shape.attr();\n                var keyShapeStyles_1 = {};\n                Object.keys(shapeAttrs_1).forEach(function (key) {\n                    if (key === 'img')\n                        return;\n                    var attr = shapeAttrs_1[key];\n                    if (attr && typeof attr === 'object') {\n                        keyShapeStyles_1[key] = clone(attr);\n                    }\n                    else {\n                        keyShapeStyles_1[key] = attr;\n                    }\n                });\n                // 已有样式 - 要取消的状态的样式\n                var filtetDisableStatesStyle = {};\n                var _loop_2 = function (p) {\n                    var style = styles[p];\n                    if (isPlainObject(style) && !ARROWS.includes(p)) {\n                        var subShape_1 = group.find(function (element) { return element.get('name') === p; });\n                        if (subShape_1) {\n                            var subShapeStyles_1 = clone(subShape_1.attr());\n                            each(style, function (v, key) {\n                                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                                    delete keyShapeStyles_1[key];\n                                    var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    shape.attr(key, value_1);\n                                }\n                                else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                                    delete subShapeStyles_1[key];\n                                    var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    subShape_1.attr(key, value_2);\n                                }\n                            });\n                            filtetDisableStatesStyle[p] = subShapeStyles_1;\n                        }\n                    }\n                    else {\n                        if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n                            delete keyShapeStyles_1[p];\n                            var value_3 = originStyle_1[p] ||\n                                (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) ||\n                                SHAPES_DEFAULT_ATTRS[type][p];\n                            shape.attr(p, value_3);\n                        }\n                    }\n                };\n                // styles 为要取消的状态的样式\n                for (var p in styles) {\n                    _loop_2(p);\n                }\n                // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n                // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n                // 否则为普通对象\n                if (!keyShapeName_1) {\n                    mix(filtetDisableStatesStyle, keyShapeStyles_1);\n                }\n                else {\n                    filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n                }\n                for (var key in enableStatesStyle) {\n                    if (keptAttrs[key])\n                        continue;\n                    var enableStyle = enableStatesStyle[key];\n                    if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n                        // 把样式属性merge到keyShape中\n                        if (!keyShapeName_1) {\n                            mix(originStyle_1, (_a = {},\n                                _a[key] = enableStyle,\n                                _a));\n                        }\n                        else {\n                            mix(originStyle_1[keyShapeName_1], (_b = {},\n                                _b[key] = enableStyle,\n                                _b));\n                            delete originStyle_1[key];\n                        }\n                        delete enableStatesStyle[key];\n                    }\n                }\n                var originstyles = {};\n                deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n                var keyShapeSetted = false;\n                var _loop_3 = function (originKey) {\n                    var _d;\n                    var style = originstyles[originKey];\n                    if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n                        var subShape = group.find(function (element) { return element.get('name') === originKey; });\n                        if (subShape) {\n                            if (originKey === keyShapeName_1) {\n                                keyShapeSetted = true;\n                            }\n                            if (originKey !== 'collapse-icon')\n                                subShape.attr(style);\n                        }\n                    }\n                    else if (!keyShapeSetted) {\n                        var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n                        shape.attr((_d = {},\n                            _d[originKey] = value_4,\n                            _d));\n                    }\n                };\n                for (var originKey in originstyles) {\n                    _loop_3(originKey);\n                }\n            }\n        },\n    }, 'single-node');\n    // 注册边\n    G6.registerEdge('labels-line', {\n        // @ts-ignore\n        draw: function draw(cfg, group) {\n            if (cfg === void 0) { cfg = {}; }\n            var edgeCfg = cfg.edgeCfg, value = cfg.value;\n            var _a = getPathText(value), text = _a.text, subText = _a.subText;\n            var _b = edgeCfg, edgeStyle = _b.style, labelCfg = _b.label;\n            var _c = getPathInfo(cfg), startArrow = _c.startArrow, endArrow = _c.endArrow, path = _c.path, line2StartPoint = _c.line2StartPoint, endY = _c.endY;\n            var _d = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {}, labelStyle = _d.style, _e = _d.margin, margin = _e === void 0 ? 4 : _e;\n            var line = group.addShape('path', {\n                attrs: __assign({ path: path, stroke: '#ccc', startArrow: startArrow, endArrow: endArrow }, (typeof edgeStyle === 'function' ? edgeStyle(cfg, group) : edgeStyle)),\n                name: 'path-shape',\n            });\n            var createItem = function (itemText, key, attrs) {\n                group.addShape('text', {\n                    attrs: __assign({ text: itemText, x: line2StartPoint.x }, attrs),\n                    name: \"line-text-\".concat(key),\n                });\n            };\n            if (text) {\n                var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, 'text'));\n                var offsetY = subText ? Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2 : 0;\n                createItem(text, 'text', __assign({ y: endY - offsetY - margin / 2 }, textStyle));\n            }\n            if (subText) {\n                var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, 'subText'));\n                var offsetY = Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2;\n                createItem(text, 'subText', __assign({ y: endY + offsetY + margin / 2 }, textStyle));\n            }\n            return line;\n        },\n        // @ts-ignore\n        update: function (cfg, edge) {\n            var edgeCfg = cfg.edgeCfg, value = cfg.value;\n            var _a = getPathText(value), text = _a.text, subText = _a.subText;\n            var group = edge.getContainer();\n            var getShape = function (shapeName) {\n                return group.get('children').find(function (item) { return item.get('name') === shapeName; });\n            };\n            var _b = getPathInfo(cfg), startArrow = _b.startArrow, endArrow = _b.endArrow, path = _b.path, line2StartPoint = _b.line2StartPoint, endY = _b.endY;\n            var _c = edgeCfg, edgeStyle = _c.style, labelCfg = _c.label;\n            var _d = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {}, labelStyle = _d.style, _e = _d.margin, margin = _e === void 0 ? 4 : _e;\n            // path\n            var pathShape = getShape('path-shape');\n            pathShape === null || pathShape === void 0 ? void 0 : pathShape.attr(__assign({ path: path, stroke: '#ccc', startArrow: startArrow, endArrow: endArrow }, (typeof edgeStyle === 'function' ? edgeStyle(cfg, group) : edgeStyle)));\n            // path text\n            var texts = ['text', 'subText'];\n            var hasSubText = !!getShape(\"line-text-subText\");\n            texts.forEach(function (key) {\n                var textShape = getShape(\"line-text-\".concat(key));\n                var textStyle = __assign(__assign({}, defaultLineLabelStyle), getStyle(labelStyle, cfg, group, key));\n                var offsetY = hasSubText ? Number((\"\".concat(textStyle.fontSize) || '12').replace(/px/g, '')) / 2 : 0;\n                textShape === null || textShape === void 0 ? void 0 : textShape.attr(__assign({ x: line2StartPoint.x, y: key === 'text' ? endY - offsetY - margin / 2 : endY + offsetY + margin / 2, text: key === 'text' ? text : subText }, textStyle));\n            });\n        },\n    }, 'single-edge');\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}